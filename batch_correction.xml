<tool id="Batch_correction" name="Batch_correction" version="2.0.4">
  <description>Corrects intensities for signal drift and batch-effects</description>

  <requirements>
    <requirement type="package">r-batch</requirement>
    <requirement type="package">r-ade4</requirement>
    <requirement type="package">bioconductor-pcamethods</requirement>
    <requirement type="package">bioconductor-ropls</requirement>
  </requirements>

  <stdio>
    <exit_code range="1:" level="fatal" />
  </stdio>
  
  <command><![CDATA[
    #if str($span_condition.method) == 'all_loess_pool':
        Rscript $__tool_directory__/batch_correction_all_loess_wrapper.R
        dataMatrix "$dataMatrix"
        sampleMetadata "$sampleMetadata"
        variableMetadata "$variableMetadata"
        method "all_loess_pool"
        span "${span_condition.span}"
    
    #elif str($span_condition.method) == 'all_loess_sample':
        Rscript $__tool_directory__/batch_correction_all_loess_wrapper.R
        dataMatrix "$dataMatrix"
        sampleMetadata "$sampleMetadata"
        variableMetadata "$variableMetadata"
        method "all_loess_sample"
        span "${span_condition.span}"
    #else:
        Rscript $__tool_directory__/batch_correction_wrapper.R
        analyse "batch_correction"
        dataMatrix "$dataMatrix"
        sampleMetadata "$sampleMetadata"
        variableMetadata "$variableMetadata"
        method "${span_condition.method}"
        #if str($span_condition.method) == 'linear':
            span "none"
        #else:
            span "${span_condition.span}"
        #end if
	valnull "${span_condition.valnull}"
        ref_factor "${span_condition.ref_factor}"
        detail "${span_condition.detail}"
    #end if
    dataMatrix_out "$dataMatrix_out" variableMetadata_out "$variableMetadata_out"
    graph_output "$graph_output"  rdata_output "$rdata_output"
  ]]></command>

	<inputs>
		<param name="dataMatrix" label="Data Matrix file " format="tabular" type="data" />
		<param name="sampleMetadata" label="Sample metadata file " format="tabular" type="data" help="must contain at least the three following columns: 'batch' + 'injectionOrder' + 'sampleType'"/>
		<param name="variableMetadata" label="Variable metadata file " format="tabular" type="data" />
		
		<conditional name="span_condition">
			<param name="method" label="Type of regression model " type="select" help="To select between linear or non-linear (lowess or loess) methods to be used in Van der Kloet algorithm ; when using loess, you can choose to use pools or samples to model batch effect.">
				<option value="linear">linear</option>
				<option value="lowess">lowess</option>
				<option value="loess">loess</option>
				<option value="all_loess_pool">all loess pool</option>
				<option value="all_loess_sample">all loess sample</option>
			</param>
			<when value="linear">
				<param name="valnull" label="Null values" type="select" display="radio" help="What to do of generated negative or infinite values">
					<option value="0">consider it as a null intensity</option>
					<option value="NA">consider it as a missing value</option>
				</param>
				<param name="ref_factor" label="Factor of interest " type="text"  value="batch" help="column name of factor of interest (often a biological factor); if none, leave 'batch'" />
				<param name="detail" label="Level of details for plots " type="select" help="Amount of plots in the pdf file output. See Help section for more details.">
					<option value="no">basic</option>
					<option value="plot">standard</option>
					<option value="reg">complete</option>
				</param>
			</when>
			<when value="lowess">
				<param name="span" type="float" value="0.85" label="span" help="it is a advanced option. Must be less than or equal to 1"/>
				<param name="valnull" label="Null values" type="select" display="radio" help="What to do of generated negative or infinite values">
					<option value="0">consider it as a null intensity</option>
					<option value="NA">consider it as a missing value</option>
				</param>
				<param name="ref_factor" label="Factor of interest " type="text"  value="batch" help="column name of factor of interest (often a biological factor); if none, leave 'batch'" />
				<param name="detail" label="Level of details for plots " type="select" help="Amount of plots in the pdf file output. See Help section for more details.">
					<option value="no">basic</option>
					<option value="plot">standard</option>
					<option value="reg">complete</option>
				</param>
			</when>
			<when value="loess">
				<param name="span" type="float" value="1" label="span" help="it is a advanced option. Must be strictly greater than 0"/>
				<param name="valnull" label="Null values" type="select" display="radio" help="What to do of generated negative or infinite values">
					<option value="0">consider it as a null intensity</option>
					<option value="NA">consider it as a missing value</option>
				</param>
				<param name="ref_factor" label="Factor of interest " type="text"  value="batch" help="column name of factor of interest (often a biological factor); if none, leave 'batch'" />
				<param name="detail" label="Level of details for plots " type="select" help="Amount of plots in the pdf file output. See Help section for more details.">
					<option value="no">basic</option>
					<option value="plot">standard</option>
					<option value="reg">complete</option>
				</param>
			</when>
			<when value="all_loess_pool">
				<param name="span" type="float" value="1" label="span" help="smoothing parameter; must be > 0"/>
			</when>
			<when value="all_loess_sample">
				<param name="span" type="float" value="1" label="span" help="smoothing parameter; must be > 0"/>
			</when>
		</conditional>
	</inputs>
	
	<outputs>
		<data name="dataMatrix_out" label="${tool.name}_${span_condition.method}_${dataMatrix.name}" format="tabular"/>
		<data name="variableMetadata_out" label="${tool.name}_${span_condition.method}_${variableMetadata.name}" format="tabular"/>
		<data name="graph_output" label="${tool.name}_${span_condition.method}_graph" format="pdf"/>
		<data name="rdata_output" label="${tool.name}_${span_condition.method}_rdata" format="rdata"/>
	</outputs>

  <tests>
    <test>
      <param name="dataMatrix" value="input-batchcorrection-dataMatrix.tsv"/>
      <param name="sampleMetadata" value="input-batchcorrection-sampleMetadata.tsv"/>
      <param name="variableMetadata" value="input-batchcorrection-variableMetadata.tsv"/>
      <param name="method" value="all_loess_pool"/>
      <param name="span" value="1"/>
      <output name="dataMatrix_out" file="output-batchcorrection-dataMatrix.tsv"/>
    </test>
  </tests>
	
	
	<help>

.. class:: infomark

**Authors**
  | Jean-Francois Martin - PF MetaToul-AXIOM ; INRA ; MetaboHUB (for original version of this tool and overall development of the R script)
  | Melanie Petera - PFEM ; INRA ; MetaboHUB (for R wrapper and R script improvement)
  | Marion Landi - FLAME ; PFEM ; INRA ; MetaboHUB (for xml interface and R wrapper)
  | Franck Giacomoni - PFEM ; INRA ; MetaboHUB (for xml interface and R wrapper)
  | Etienne Thevenot - LIST/LADIS ; CEA ; MetaboHUB (for R script and wrapper regarding "all loess pool" and "all loess sample" methods)

---------------------------------------------------

.. class:: infomark

**Please cite** If you use this tool, please cite:

when using the **linear**, **lowess** or **loess** methods:
  | `F.M. Van Der Kloet, I. Bobeldijk, E.R. Verheij, R.H. Jellema. (2009). "Analytical error reduction using single point calibration for accurate and precise metabolomic phenotyping." Journal of Proteome Research p5132-5141 &lt;http://www.ncbi.nlm.nih.gov/pubmed/19754161&gt;`_

when using the **all loess pool** or **all loess sample** method:
  | `Dunn et al (2011). Procedures for large-scale metabolic profiling of serum and plasma using gas chromatography and liquid chromatography coupled to mass spectrometry. Nature Protocols, 6:1060-1083 &lt;http://dx.doi.org/10.1038/nprot.2011.335&gt;`_
  | Cleveland et al (1997). In Statistical Models in S; Chambers JM. and Hastie TJ. Ed.; Chapman et Hall: London; pp. 309-376
  | Etienne A. Thevenot, Aurelie Roux, Ying Xu, Eric Ezan, and Christophe Junot (2015). Analysis of the human adult urinary metabolome variations with age, body mass index and gender by implementing a comprehensive workflow for univariate and OPLS statistical analyses. *Journal of Proteome Research*, **14**:3322-3335 (http://dx.doi.org/10.1021/acs.jproteome.5b00354).

---------------------------------------------------

.. class:: infomark

**Tool updates**

See the **NEWS** section at the bottom of this page
  
---------------------------------------------------

================
Batch_correction
================

-----------
Description
-----------

| **Instrumental drift** and **offset differences** between batches have been described in **LC-MS** experiments when the number of samples is large and/or multiple batches of acquisition are needed.
| Recently a normalization strategy relying on the measurements of a **pooled** (or QC) sample injected periodically has been described: for each variable, a **regression model** is fitted to the values of the **pool** and subsequently used to adjust the intensities of the samples of interest (van der Kloet et al, 2009; Dunn et al, 2011).
|
| The current tool implements **two strategies** which differ in the way the regression model is applied to the variables (either depending on variable quality metrics, or 'loess' model for all variables) and also in the generated figure.
|


-----------------
Workflow position
-----------------

.. image:: batch_correction.png
        :width: 800


-----------
Input files
-----------

+----------------------------+------------+
| Parameter : num + label    |   Format   |
+============================+============+
| 1 : Data Matrix file       |   tabular  |
+----------------------------+------------+
| 2 : Sample metadata file   |   tabular  |
+----------------------------+------------+
| 3 : Variable metadata file |   tabular  |
+----------------------------+------------+


Data Matrix file must contain the intensity values of variables.
	| First line must contain all the samples' names
	| First column must contain all the variables' ID
	| 

Sample metadata file must contain at least the three following columns: 
	| "batch" to identify the batches of analyses
	| "injectionOrder" (integers) defining the injection order of all samples (QC-pools as well as analysed samples)
	| "sampleType" indicating if a sample ("sample") or a QC-pool ("pool"); each batch needs
	| at least 3 QC-pools for intra-batch linear adjustment and 8 for lo(w)ess adjustment (5 for **all loess** methods)


.. class:: warningmark

MISSING DATA are allowed only with the **all loess** methods


----------
Parameters
----------

Type of regression model
	| To choose between *linear*, *lowess*, *loess*, *all loess pool*, and *all loess sample* strategies
	| **- Option 1** (**linear**, **lowess**, and **loess** methods): before the normalisation of each variable, some quality metrics are computed (see the "Determine Batch Correction" module); depending on the result, the variable can be normalized or not, with either the **linear**, **lowess** or **loess** model.
	| **- Option 2** (**all loess pool** and **all loess sample**): each variable is normalized by using the 'loess' model;
	| in the case **all loess pool** is chosen and the number of pool observations is below 5, the linear method is used (for all variables) and a warning is generated;
	| if the pool intensities are not representative of the samples (which can be viewed on the figure where both trends are shown), the case **all loess sample** enables using the sample intensities (instead of the pool intensities) as the reference for the loess curve.
	| In all "option 2" cases: the **median intensity of the reference observations** (either 'pool' or 'sample') is used as the scaling factor after the initial intensities have been divided by the loess predictions.
	|

Span
	| Smoothing parameter, advanced option for *lo(w)ess* and *all loess* methods
	| In case of a loess fit, the **span** parameter (between 0 and 1) controls the smoothing
	| (the higher the smoother; higher values are prefered to avoid overfitting; Cleveland et al, 1997).
	|

Null values
	| available for regression model *linear*, *lowess* and *loess*
	| Controls what is done regarding negative or infinite values that can be generated during regression estimation. 
	| *consider it as a missing value* will switch concerned intensities to NA;
	| this option implies that concerned ions will not be considered in PCA display. 
	| *consider it as a null intensity* will switch concerned intensities to 0 for lo(w)ess
	| or correct them by the batch mean instead of regression estimate for linear. 
	| 

Factor of interest
	| available for regression model *linear*, *lowess* and *loess*
	| Name of the factor (column header) in Sample metadata file that will be used as a categorical variable for plots and PCA.
	| (often a biological factor ; if none, leave "batch")
	| This factor does not affect correction calculation.
	| 

Level of details for plots
	| available for regression model *linear*, *lowess* and *loess*
	| *basic*: PCA + CV boxplot (before and after correction)
	| *standard*: 'basic' plots + before/after-correction plots of intensities over injection order, and design effects for each ion
	| *complete*: 'standard' plots + QC-pool regression plots per batch with samples' intensities over injection order
	| This factor is not used by the *all loess* methods where a unique figure is generated showing the sum of intensities along injection order, and the first 4 PCA scores.
	| 


------------
Output files
------------

Batch_correction_$method_rdata.rdata
	| binary data
	| Download, open R and use the 'load' function; objects are in the 'res' list
	|

Batch_correction_$method_graph.pdf
	| graphical output
	| For the *linear* and *lo(w)ess* methods, content depends on level of details chosen 
	|

Batch_correction_$method_variableMetadata.tabular
	| tsv output
	| Identical to the Variable metadata input file, with x more columns (where x is the number of batches) in case of *linear*, *lowess* and *loess* methods
	|

Batch_correction_$method_dataMatrix.tabular
	| tsv output (tabulated)
	| Same formatting as Data Matrix file; contains corrected intensities
	|

	
---------------------------------------------------

---------------
Working example
---------------

.. class:: warningmark

Refer to the corresponding "W4M HowTo" page:
 | `MS data processing - Filters and normalisation &lt;http://workflow4metabolomics.org/sites/workflow4metabolomics.org/files/files/w4e-2016-data_processing.pdf&gt;`_
 |
 |

See also the reference history:
 | `W4M00001_Sacurine-statistics (DOI:10.15454/1.4811121736910142E12) &lt;http://dx.doi.org/10.15454/1.4811121736910142E12&gt;`_
 |

---------------------------------------------------

----
NEWS
----

CHANGES IN VERSION 2.0.4
========================

INTERNAL MODIFICATIONS  

For PCA figure display only ("all_loess_" options): missing values are set to the minimum value before PCA computation is performed (with svd)

Additional running and installation tests added with planemo, conda, and travis

BUG FIX

Variables with NA or 0 values in all reference samples are discarded before applying the **all_loess** normalization

INTERNAL MODIFICATIONS

Modifications of the **all_loess_wrapper** file to handle the recent **ropls** package versions (i.e. 1.3.15 and above) which use S4 classes

  </help>
      <!-- [RECOMMANDED] All citations associated to this tool (main citation given above and other references). Can be extracted from the history panel -->
    <citations>
        <!-- [HELP] As DOI or BibTex entry -->
        <citation type="doi">10.1021/pr900499r</citation>
        <citation type="doi">10.1038/nprot.2011.335</citation>
        <citation type="bibtex">@ARTICLE{Cleveland91,
            author = {Cleveland et al},
            year = {1991},
            journal = {Statistical Models in S, Chambers JM. and Hastie TJ. Ed., Chapman et Hall: London},
            title = {Local Regression Models},
            pages = {309-376},
            editor = {Chambers JM. and Hastie TJ. Ed.},
            publisher = {Chapman et Hall: London},
            chapter = {8}
        }</citation>
	<citation type="doi">10.1021/acs.jproteome.5b00354</citation>
    </citations>
	
<!--

example 1:

Input files
===========

| **To generate the "dataMatrix", "sampleMetadata" and "variableMetadata" files:**
|   **1) copy/paste the values below in three distinct .txt files**
|   **2) use the "Get Data" / "Upload File" in the "Tools" (left) panel from the Galaxy page by choosing:**
|     **Convert spaces to tabs: 'Yes'**
| 

**dataMatrix file**::

	dataMatrix QC1_001 HU_017 HU_018 HU_020 HU_021 HU_027 HU_028 HU_032 HU_034 QC1_002 HU_037 HU_041 HU_043 HU_044 HU_047 HU_048 QC1_003 HU_049 HU_050 HU_051 HU_052 HU_055 HU_060 HU_061 QC1_004 HU_064 HU_065 HU_066 HU_068 HU_072 HU_077 HU_078 QC1_005 HU_079 HU_083 HU_086 HU_088 HU_089 HU_090 HU_091 HU_093 HU_094 QC1_006 HU_099 HU_100 HU_101 HU_105 HU_107 HU_108 HU_109 HU_110 QC1_007 HU_116 HU_118 HU_123 HU_125 HU_126 HU_127 QC1_008 HU_130 HU_131 HU_132 HU_133 HU_134 HU_138 QC1_009 HU_144 HU_148 HU_149 HU_150 QC1_010 HU_152 HU_154 HU_156 HU_157 HU_158 HU_163 HU_170 HU_171 QC1_011 HU_172 HU_173 HU_174 HU_175 HU_179 HU_180 HU_181 HU_182 QC1_012 HU_184 HU_185 HU_186 HU_189 HU_192 HU_196 QC1_013 HU_200 HU_201 HU_202 HU_204 HU_207 HU_208 HU_209 QC1_014 QC1_015 HU_022 HU_076 HU_166 HU_114 HU_190 HU_139 HU_096 HU_058 HU_031 QC1_016 HU_039 HU_087 HU_143 HU_162 HU_102 HU_188 HU_095 HU_062 QC1_017 HU_063 HU_011 HU_074 HU_122 HU_142 HU_030 HU_187 HU_167 HU_113 QC1_018 HU_081 HU_014 HU_206 HU_119 HU_033 HU_067 HU_140 HU_164 HU_193 HU_112 QC1_019 HU_097 HU_056 HU_195 HU_135 HU_159 HU_070 HU_038 HU_026 QC1_020 HU_098 HU_115 HU_137 HU_019 HU_073 HU_168 HU_191 HU_040 HU_046 QC1_021 HU_103 HU_015 HU_053 HU_121 HU_183 HU_199 HU_042 HU_075 QC1_022 HU_203 HU_024 HU_082 HU_169 HU_129 HU_057 HU_035 HU_194 HU_145 QC1_023 HU_177 HU_025 HU_080 HU_117 HU_136 HU_197 HU_036 HU_054 HU_085 QC1_024 HU_160 HU_092 HU_023 HU_124 HU_147 HU_205 HU_084 HU_120 HU_198 QC1_025 HU_045 HU_029 HU_069 HU_155 HU_106 HU_146 QC1_026
	met_001 17558910 10657431 13044183 7261208 6909491 2594571 12751984 13522888 13894507 16393604 7865097 3630317 7503242 8537528 5503464 4587754 17599767 8473703 25556162 1332303 13312536 5073342 26036420 4959938 16841618 5608314 29332804 10491655 23448752 19921296 21471497 21223304 17008026 8908921 21091221 51170137 7921432 16085480 13789362 14424243 14714241 8362817 16699474 6133088 26413961 1605625 9660665 35717402 280575 1976782 2568169 15026529 6552813 16307390 12123953 13480559 22963554 12249347 13888520 17165271 17470093 12811880 12013641 18118700 19560902 13687923 25942102 16394638 24333092 12590296 12722221 10992119 6223253 1623756 10758763 2121817 7813434 12500471 12705530 11102165 17869823 9436102 11637518 4185206 3758974 10169281 2777795 5497423 10321096 3558399 944424 7181581 3180237 7866370 8184772 9332856 21413125 4177729 2968557 23287406 6301903 2265236 5640134 8113388 34046147 29268048 43765299 44375419 50601116 4832613 40454119 8126 19479962 11235683 33064844 75260138 36891690 17466250 74160059 32122101 5238560 30163448 10216046 31450577 17301601 11549910 12734389 54057483 3488082 24301846 2046492 23004592 9579482 30075694 7571631 5257922 60032654 15725469 42794552 12202672 10427301 17332850 2558158 66102394 29666404 34174908 36717068 24271602 36414651 37145056 20074559 1865267 5837544 27608715 38999155 21669105 14372963 36030678 24509866 1906953 15589584 18219005 25991397 25068509 21518123 17608775 6613249 4124652 30008362 7839717 16104411 36946332 23198059 6151472 23334545 18392766 27331396 30774819 18461787 42246522 20479189 28817403 21703591 17170407 13809778 11188751 14478896 8256694 2771227 47261207 21462355 24438964 19424590 379608 17107855 14512991 31446516 24437179 18499953 16786178 1370420 23336305 18279598 9162668 29590881 24605602 13020657 30919250 16843645 15320951
	met_002 12037919 5702720 7724079 5846622 3741354 1619186 8308588 10475983 8866798 10764382 5248814 1752090 3586935 5649821 3332032 1455632 12076113 7022272 17257916 790006 8001254 4081612 14448505 1728124 11199452 2821369 20617894 4015724 11583395 14491653 15160968 17298344 10641794 3539170 10102013 32955314 2950169 8273042 8215773 8089397 10273497 3824079 10669021 3202335 16728456 382916 6743005 23114124 1284583 1346657 2112594 9333659 4819835 10460181 7324554 6798625 16794394 6033274 8756254 12577194 13068405 6864352 6633172 10808251 8594814 8067200 14024254 9776257 14993718 10131633 7675147 4433477 3614369 463546 6501316 1366491 4662110 7496747 8795154 6314659 7566829 5958471 5268657 1615545 1404829 7257302 1785651 3718731 5867365 2265971 639817 3541595 1499548 4184836 4255768 4987047 13006022 1963870 1029730 13763285 3270146 1203305 3139612 4423771 25505104 13027974 32763597 34730095 33371485 1895066 27495574 59974 13416309 7415642 23483152 56144021 29010226 13269573 61487618 21195395 3379894 23790609 4902552 23924391 10425200 5914542 10652705 32854120 835047 13453508 1274458 22515044 4126230 22230978 1786393 3285537 42606906 22882567 35048135 9125465 3968320 10918248 2767218 40862097 20287479 21966458 30969969 17039420 20122412 28288256 13281775 1926605 10855072 19582666 28740009 14276670 8544427 28305898 17921960 1108003 15397507 12237865 16183896 17724624 12764878 19325552 5978795 2327941 19932606 3940696 8131604 27569944 16730669 4383418 15424544 10734487 33257422 21428567 10875162 33291902 12687175 13724743 15859004 7722135 10212514 5089001 10323782 5299453 529447 39682428 18277950 17763884 14171656 997710 14321798 12297861 15992338 26897819 12146700 13597912 256757 14051155 13070239 6274244 20895482 17767113 13249946 20766019 15026075 11032203
	met_003 4566540 1328899 2213443 1243524 736206 533783 2689603 2100159 1851599 4033529 1248207 285999 1390408 1342791 1272772 920305 3749561 1848464 5233112 123268 1842586 1248149 7276851 1290073 4038810 954732 5964578 2746789 5313908 5340057 3945790 6307737 3471362 1550880 8263233 16527944 1331503 4386727 3151172 2965373 2365908 3180758 3563498 1118766 6615889 168860 1827455 8588255 28109 219550 434366 3076402 1749826 3692288 2062432 3927519 6784505 2882693 2873528 3500539 3429536 3468254 2924851 4456246 4930207 2561369 5193056 2773649 8863061 1971068 2440254 1863912 2298627 137964 2108839 429775 1710473 2534167 1686345 2184238 3676224 1683278 3287688 842092 287640 1941309 456801 763330 1831535 458744 924805 1297127 1604090 1459317 2168010 1719525 5199944 391930 479097 5422102 1106345 310338 944285 1549588 5892635 10312094 7821772 11024697 11099724 211356 15572436 NA 5081385 1287012 7083236 11463946 10268577 3466442 16572946 7596396 515301 5605033 1166691 6692258 5258935 1120354 2768153 17622620 100138 5657045 155546 3993478 895432 6630262 1160086 1398006 20292345 8345069 9496638 2281112 1622765 559527 1169164 24371841 6010179 5988080 6808771 4430121 6994393 13311751 5318285 783176 353306 5788416 6714250 6043357 3119950 4761136 4840500 316705 2576605 4562242 7534703 5546336 3149195 2525989 2463379 413059 4398279 855987 2243033 6719671 4189278 1103830 3718953 5441941 4324385 9454992 5764607 7703610 7439304 5651876 4075671 5884945 2071030 822119 2324725 1072516 75496 15134893 4124869 5293399 3395800 NA 2578641 5179943 5878251 8146783 4702730 2191032 34289 4192685 3234808 2907002 8592351 5858938 1541012 10652067 3600540 2932946
	met_004 13830451 3085203 7049050 5793780 4813720 4378340 8011651 8451754 4982882 12641914 2411753 1400107 6174585 5733729 3807740 4697185 11988883 7699264 13879675 831703 9968950 8705364 12668435 5277566 11191507 3177895 17270092 7915283 11211461 15465514 12867390 17221913 10578096 5500479 17503122 29636845 2657662 9052789 10759167 7131250 7353516 10023936 11816229 4169400 12738320 424248 4949994 11848354 201374 827868 3151094 10020090 8280861 9286713 3993213 9503828 12403087 9717423 7961046 10461971 7667267 13598413 7726722 8778417 10883670 7925779 9802502 7503086 18030982 7985887 7922340 3325205 4733187 411360 6692749 1874296 5476864 6488536 5179328 6268539 4477422 5988385 8130675 3346104 1108283 6259949 2516648 2919853 5619616 1302465 924805 3942449 3933856 3461644 5175048 4980616 7814934 1389874 1312764 8842685 3831844 1483014 2494071 4725673 22027726 28338717 19767257 776755 29237805 551519 43361691 17669 24178241 2483160 22961817 36696085 29568489 12694039 38098794 28957490 4548936 21546827 8439927 23754498 19390563 2410036 15610073 48462830 743472 12281479 957970 22957209 3382722 23184843 3152846 6026857 29934738 37430772 28469408 6392048 3956769 18521915 6448619 58495251 21643123 15824960 24311549 14867509 14415999 39238537 19313537 4269597 14077517 20163043 27340905 24795934 11392689 16957319 8784709 3302430 14801777 21374299 22691590 18798091 10791789 9245374 9321953 3946445 19030931 2851153 7951878 18647008 15091482 4856406 12502732 10638134 17097174 26807402 12496560 23261771 14881802 11744963 14116064 15472403 6386433 5112117 13146747 7167783 236477 24538222 12591822 14722588 13063460 971573 5200985 16805865 7198114 10515461 10722786 13053078 70163 7465055 11687904 10088325 16368703 10706813 7486089 18535386 10598026 11077483
	met_005 131638 43780 NA 94438 47169 35839 104575 336251 39835 154736 NA 112319 107102 74453 86059 297958 146799 41608 139302 51875 428629 54149 310403 66390 144710 41770 313946 101762 318834 96645 242381 98808 132564 124925 306907 275298 349075 34656 114441 80007 51698 127731 144062 125757 104208 11847 182544 5005 NA 27844 50618 128536 71052 74978 342528 167230 177130 171413 119954 57028 48189 167552 247338 114772 187546 101523 76680 13572 84009 NA 104696 271633 45149 31758 197899 61430 121584 22244 26324 100446 52285 82234 228185 97527 14318 122384 48376 44253 94377 82745 24395 2009 108366 90927 179232 85496 190340 42625 34229 106511 557311 36402 1953 78743 193306 160570 117718 769008 267248 87972 69464 NA 7616 586103 206378 121127 213298 176754 242462 245818 45143 24490 755359 212954 389071 155435 184599 376084 254437 250988 220902 108105 85318 195162 67546 734516 831034 585004 173521 26533 200539 37004 36565 325985 158874 37276 113890 74761 146784 220431 131561 15431 110818 185203 364047 240219 148084 86018 66224 52249 24283 80448 106180 166432 305441 70418 43991 25483 105589 447093 262598 155739 174455 41989 105672 178424 62375 119866 161191 297693 7959 153233 158356 187841 114849 305398 278998 61269 170611 140724 312751 224186 111426 283256 122690 12793 132190 54212 39050 307170 167079 342338 117560 30651 47048 93554 318603 259085 46862 147634
	met_006 170215 51922 178667 62116 112544 50672 231879 117812 96995 172200 115071 93037 130855 45028 85943 238287 134247 139055 167944 30380 142637 71182 153027 119033 158826 33391 177745 161039 116709 165654 227053 125757 142185 136490 116863 343873 192541 115782 98705 183534 33032 58981 119554 122377 118487 88344 89418 83958 29312 34904 88971 124923 76525 48905 120894 148481 103686 131993 115794 107179 82177 91929 95517 126929 276713 95087 127934 85333 144209 47143 100101 151743 60473 40777 75298 57945 85853 97761 45700 85843 142614 46086 58704 116756 66111 82492 29649 28734 64940 48443 36114 14794 107623 141827 145326 67448 55668 69813 66701 68051 46064 22822 77397 69889 211051 135473 187526 171919 231183 810849 268826 14883 140778 961904 226143 242014 319702 117739 220563 250808 134880 190902 266216 196054 378433 125874 163055 211658 267996 164365 130178 69163 188919 200864 549987 119612 366293 277418 275988 349089 132186 127157 181774 459213 215864 260424 246803 172018 274592 191312 209141 45084 107075 183816 169029 153489 283856 133961 202937 64740 153310 227788 74044 180132 127350 169212 54206 77563 90445 186680 154867 132619 160787 147476 89801 223338 49267 91754 117057 429902 156194 161023 128511 229049 106582 94783 172129 45728 134762 82872 103303 187390 118078 128191 153646 50982 265774 120179 187030 55772 86739 98350 117721 39963 89854 113185 66975 57334 79878 92214
	met_007 366495 43811 85848 137203 125991 606034 41185 123263 32220 327022 43517 79436 22183 80989 153673 22765 305953 NA 21055 2878 1568733 19359 31430 18881 256933 9564 46599 3066 40611 3543 25004 66306 287882 11416 76738 108838 270252 104005 4552 17929 131058 139833 295919 20628 8337 11627 13025 3631 3117 182282 123331 280937 9425 34361 35143 97782 31110 2257554 235247 81059 296506 95353 58228 241157 13737 207750 146632 331862 107826 62764 196103 16788 45119 2769 12781 13718 357130 156802 25886 195573 72941 21130 10409 10399 53759 57032 74657 42261 156097 45381 26861 35408 35400 12081 104843 145420 19370 57995 42189 1911 37938 30170 43540 141375 818506 163659 149350 42654 19086 40670 16834 NA 83422 14392 917690 187463 132703 60940 142185 36582 300958 105092 47811 1019078 90157 416430 4545917 286788 39925 40803 334919 348959 587342 1056928 70427 277858 29565 77759 300874 558218 86201 171841 155957 231157 961115 461295 79343 199413 567908 183811 27940 290004 598012 904557 69335 39497 102278 460376 619162 157373 92338 43550 225869 991990 155355 1691486 187202 219564 122953 65541 60088 103865 418710 139551 117097 113709 149458 116594 10610459 562050 62310 818129 759613 77860 71197 308475 25127 66760 482726 63049 99118 1510403 254158 177554 67325 8044525 238376 61584 207355 539960 1021892 69544 302540 198680 162514 1869389 414321 143692 69007 251060
	met_008 63712 5178 41746 14512 NA 14001 51128 17671 45533 77496 22790 18049 48592 28408 30678 66033 83203 43531 134232 12239 154857 21049 83216 37152 90443 NA 104366 58987 108449 124041 229639 109421 103850 37243 197850 348086 149226 69129 182116 237382 71826 20634 115770 91736 140884 2226 137858 307418 NA 22509 10790 111910 68777 67302 63222 124745 124716 60862 135941 188364 248426 258672 63396 208156 117842 127360 279817 158288 147569 165500 139353 146268 117350 108271 150174 27504 196787 95774 79485 147863 188739 127152 143120 50910 71015 163461 38488 50746 131275 131697 12811 112342 93179 131425 163821 137844 294040 51513 102588 289834 53281 9554 97621 139527 115231 264286 74049 81590 40554 91022 NA NA 8314 117029 123182 176584 112223 62435 1253934 79918 5194 87966 19155 135564 224648 242477 76601 213640 152349 44170 4600 100077 120950 160307 110075 5148 67076 145278 296041 76923 52954 92403 20685 160750 150374 159163 94619 7721 185397 29210 325518 5027 29938 139840 151394 37141 22918 169812 58483 4970 4800 71212 78834 153726 268147 173775 48985 3938 294626 21894 100149 219771 159618 21203 22559 355926 126593 305741 226602 101954 249392 225758 193691 115110 132081 348624 143535 11300 112369 826089 166256 116212 192909 112650 381004 26447 629000 156376 159434 161587 221871 155021 191730 14293 204085 53770 152941 369783 96341 202972
	met_009 1503033 464311 3057689 281762 1055501 436878 1516553 442132 714402 923332 252752 478663 1754448 387980 364311 1900445 740741 2180362 1424552 152581 645749 162877 1091550 637020 597966 101492 1191716 1272790 919328 565770 806905 1082238 573526 199702 1223439 1725609 691577 399296 1235793 570895 261792 352369 443590 1350887 522959 1050840 260486 586856 209664 181956 311250 424202 99383 382428 773001 188757 508323 827735 327375 741495 766087 1028942 327905 621748 499903 287871 604128 690058 641631 571334 288901 349325 329660 306344 164080 805613 434639 365490 501134 365722 137618 350140 199022 165053 549460 257263 138433 292353 219770 235020 576413 560318 221050 335576 343726 236533 100824 378712 529165 298372 78279 415243 451552 173188 1653183 336731 1586628 623933 511108 2144040 3908910 2612 332173 3718606 750541 1839009 412482 296926 1397136 779507 803159 797478 2253026 673007 1246516 261712 636769 1252614 1872139 1123410 1211241 450421 2269400 674746 1202999 714934 923463 650730 1707553 1380296 447317 551744 1801836 1017392 629148 536723 260636 1240058 1100354 1471142 502127 379856 225008 655259 258475 247050 1387340 760882 360828 835191 1467559 1277554 693606 643990 406054 658403 308357 575599 3355208 3344141 1814947 3033916 2487138 3666036 2208895 3384287 1147554 1431141 1187374 1500354 3213137 456834 1177754 234995 3157451 4225889 2007199 743424 3797450 2860315 888468 2785386 2234912 1866417 1828194 1763480 1349066 1177795 1230768 1347281 387911 2497497 1540837 748978 2118929 448664 880734 2350718 2963789 2223983
	met_010 3454436 85570 5185354 768813 811585 629992 184654 130644 12745703 3171325 34949 101341 1162245 633029 1205837 217339 3051202 559468 12353676 26708 683830 68196 10084334 1419775 2784483 551247 18012335 610982 474097 1737802 823040 10194318 2715478 667071 5804019 1072206 1640035 702597 888833 20006253 936924 4236792 2775358 1435485 323503 249063 255578 1335088 329814 128872 282063 2530336 141280 73415 293779 570529 4727215 2378852 2230139 2741088 3913115 4420164 273214 329937 1298791 2058717 1943560 6076204 491506 201446 1858501 398550 546246 205998 270047 2450613 729311 2181006 2467710 1806793 517380 2879039 510244 4393232 103431 305884 330211 224428 1594132 143053 251745 266132 708108 1013356 674786 1458226 496794 474363 375497 684301 665478 1166802 1617420 1178598 7081822 4739444 1241927 2568237 2543303 3559207 8818294 3224 4774112 32246592 7263868 2677701 499455 4297787 675103 20655272 2307693 1654236 18080860 6979670 9996765 1007281 919441 13268847 3662733 3447668 109807 590328 1578174 6926178 11960517 1487469 10079986 483011 1634611 644542 229454 493678 2758609 5983950 6445722 483373 5116692 4341054 2652660 3285128 9214051 1725760 380224 5878072 9679727 1935469 3354872 3491777 3903044 3098324 3901596 16486928 7354595 5928774 6276978 1069606 431358 423052 3159131 1092630 1042776 1771261 4726444 1151587 1737898 8026262 1297907 7275379 6723651 6868065 2627565 5745052 5306284 2535047 5307520 269522 21581115 391810 4323746 3412789 1672193 4095309 3737559 1781359 1792450 291267 2119319 26261958 5040629 529740 362314 1887159 3808365 115792 12919439 1980086 743883 5533137 1538355 2777958
	
**sampleMetadata file**::
	
	sampleMetadata sampleType injectionOrder batch
	QC1_001 pool 1 ne1
	HU_017 sample 2 ne1
	HU_018 sample 3 ne1
	HU_020 sample 4 ne1
	HU_021 sample 5 ne1
	HU_027 sample 6 ne1
	HU_028 sample 7 ne1
	HU_032 sample 8 ne1
	HU_034 sample 9 ne1
	QC1_002 pool 10 ne1
	HU_037 sample 11 ne1
	HU_041 sample 12 ne1
	HU_043 sample 13 ne1
	HU_044 sample 14 ne1
	HU_047 sample 15 ne1
	HU_048 sample 16 ne1
	QC1_003 pool 17 ne1
	HU_049 sample 18 ne1
	HU_050 sample 19 ne1
	HU_051 sample 20 ne1
	HU_052 sample 21 ne1
	HU_055 sample 22 ne1
	HU_060 sample 23 ne1
	HU_061 sample 24 ne1
	QC1_004 pool 25 ne1
	HU_064 sample 26 ne1
	HU_065 sample 27 ne1
	HU_066 sample 28 ne1
	HU_068 sample 29 ne1
	HU_072 sample 30 ne1
	HU_077 sample 31 ne1
	HU_078 sample 32 ne1
	QC1_005 pool 33 ne1
	HU_079 sample 34 ne1
	HU_083 sample 35 ne1
	HU_086 sample 36 ne1
	HU_088 sample 37 ne1
	HU_089 sample 38 ne1
	HU_090 sample 39 ne1
	HU_091 sample 40 ne1
	HU_093 sample 41 ne1
	HU_094 sample 42 ne1
	QC1_006 pool 43 ne1
	HU_099 sample 44 ne1
	HU_100 sample 45 ne1
	HU_101 sample 46 ne1
	HU_105 sample 47 ne1
	HU_107 sample 48 ne1
	HU_108 sample 49 ne1
	HU_109 sample 50 ne1
	HU_110 sample 51 ne1
	QC1_007 pool 52 ne1
	HU_116 sample 53 ne1
	HU_118 sample 54 ne1
	HU_123 sample 55 ne1
	HU_125 sample 56 ne1
	HU_126 sample 57 ne1
	HU_127 sample 58 ne1
	QC1_008 pool 59 ne1
	HU_130 sample 60 ne1
	HU_131 sample 61 ne1
	HU_132 sample 62 ne1
	HU_133 sample 63 ne1
	HU_134 sample 64 ne1
	HU_138 sample 65 ne1
	QC1_009 pool 66 ne1
	HU_144 sample 67 ne1
	HU_148 sample 68 ne1
	HU_149 sample 69 ne1
	HU_150 sample 70 ne1
	QC1_010 pool 71 ne1
	HU_152 sample 72 ne1
	HU_154 sample 73 ne1
	HU_156 sample 74 ne1
	HU_157 sample 75 ne1
	HU_158 sample 76 ne1
	HU_163 sample 77 ne1
	HU_170 sample 78 ne1
	HU_171 sample 79 ne1
	QC1_011 pool 80 ne1
	HU_172 sample 81 ne1
	HU_173 sample 82 ne1
	HU_174 sample 83 ne1
	HU_175 sample 84 ne1
	HU_179 sample 85 ne1
	HU_180 sample 86 ne1
	HU_181 sample 87 ne1
	HU_182 sample 88 ne1
	QC1_012 pool 89 ne1
	HU_184 sample 90 ne1
	HU_185 sample 91 ne1
	HU_186 sample 92 ne1
	HU_189 sample 93 ne1
	HU_192 sample 94 ne1
	HU_196 sample 95 ne1
	QC1_013 pool 96 ne1
	HU_200 sample 97 ne1
	HU_201 sample 98 ne1
	HU_202 sample 99 ne1
	HU_204 sample 100 ne1
	HU_207 sample 101 ne1
	HU_208 sample 102 ne1
	HU_209 sample 103 ne1
	QC1_014 pool 104 ne1
	QC1_015 pool 105 ne2
	HU_022 sample 106 ne2
	HU_076 sample 107 ne2
	HU_166 sample 108 ne2
	HU_114 sample 109 ne2
	HU_190 sample 110 ne2
	HU_139 sample 111 ne2
	HU_096 sample 112 ne2
	HU_058 sample 113 ne2
	HU_031 sample 114 ne2
	QC1_016 pool 115 ne2
	HU_039 sample 116 ne2
	HU_087 sample 117 ne2
	HU_143 sample 118 ne2
	HU_162 sample 119 ne2
	HU_102 sample 120 ne2
	HU_188 sample 121 ne2
	HU_095 sample 122 ne2
	HU_062 sample 123 ne2
	QC1_017 pool 124 ne2
	HU_063 sample 125 ne2
	HU_011 sample 126 ne2
	HU_074 sample 127 ne2
	HU_122 sample 128 ne2
	HU_142 sample 129 ne2
	HU_030 sample 130 ne2
	HU_187 sample 131 ne2
	HU_167 sample 132 ne2
	HU_113 sample 133 ne2
	QC1_018 pool 134 ne2
	HU_081 sample 135 ne2
	HU_014 sample 136 ne2
	HU_206 sample 137 ne2
	HU_119 sample 138 ne2
	HU_033 sample 139 ne2
	HU_067 sample 140 ne2
	HU_140 sample 141 ne2
	HU_164 sample 142 ne2
	HU_193 sample 143 ne2
	HU_112 sample 144 ne2
	QC1_019 pool 145 ne2
	HU_097 sample 146 ne2
	HU_056 sample 147 ne2
	HU_195 sample 148 ne2
	HU_135 sample 149 ne2
	HU_159 sample 150 ne2
	HU_070 sample 151 ne2
	HU_038 sample 152 ne2
	HU_026 sample 153 ne2
	QC1_020 pool 154 ne2
	HU_098 sample 155 ne2
	HU_115 sample 156 ne2
	HU_137 sample 157 ne2
	HU_019 sample 158 ne2
	HU_073 sample 159 ne2
	HU_168 sample 160 ne2
	HU_191 sample 161 ne2
	HU_040 sample 162 ne2
	HU_046 sample 163 ne2
	QC1_021 pool 164 ne2
	HU_103 sample 165 ne2
	HU_015 sample 166 ne2
	HU_053 sample 167 ne2
	HU_121 sample 168 ne2
	HU_183 sample 169 ne2
	HU_199 sample 170 ne2
	HU_042 sample 171 ne2
	HU_075 sample 172 ne2
	QC1_022 pool 173 ne2
	HU_203 sample 174 ne2
	HU_024 sample 175 ne2
	HU_082 sample 176 ne2
	HU_169 sample 177 ne2
	HU_129 sample 178 ne2
	HU_057 sample 179 ne2
	HU_035 sample 180 ne2
	HU_194 sample 181 ne2
	HU_145 sample 182 ne2
	QC1_023 pool 183 ne2
	HU_177 sample 184 ne2
	HU_025 sample 185 ne2
	HU_080 sample 186 ne2
	HU_117 sample 187 ne2
	HU_136 sample 188 ne2
	HU_197 sample 189 ne2
	HU_036 sample 190 ne2
	HU_054 sample 191 ne2
	HU_085 sample 192 ne2
	QC1_024 pool 193 ne2
	HU_160 sample 194 ne2
	HU_092 sample 195 ne2
	HU_023 sample 196 ne2
	HU_124 sample 197 ne2
	HU_147 sample 198 ne2
	HU_205 sample 199 ne2
	HU_084 sample 200 ne2
	HU_120 sample 201 ne2
	HU_198 sample 202 ne2
	QC1_025 pool 203 ne2
	HU_045 sample 204 ne2
	HU_029 sample 205 ne2
	HU_069 sample 206 ne2
	HU_155 sample 207 ne2
	HU_106 sample 208 ne2
	HU_146 sample 209 ne2
	QC1_026 pool 210 ne2

**variableMetadata file**::
	
	variableMetadata variable number
	met_001 met 1
	met_002 met 2
	met_003 met 3
	met_004 met 4
	met_005 met 5
	met_006 met 6
	met_007 met 7
	met_008 met 8
	met_009 met 9
	met_010 met 10

Parameters
===========

| **Type of regression model**: 'all_loess_pool'
| **span**: 1 'default)

Figure output
=============

| You should obtain with this very simplified dataset the following figure:
|

.. image:: batchCorrection_workingExampleImage.png
        :width: 600


  
example 2:

Input files
===========

| **These two input files can be used in the purview "URL/Text:" of the tool "Get Data/Upload File",**
| **by checking the box "Convert spaces to tabs: YES"**

Metadata_samples.txt
	Model input Sample metadata file::

		samples idLIMS serie factor01 factor02 batch injectionOrder sampleType
		POOL1 POOL1 p p p 01_08_2011 1 p
		X12588 12588 3 validation 2 01_08_2011 2 s
		X17736 17736 3 Q1 1 01_08_2011 3 s
		X15432 15432 3 validation 1 01_08_2011 4 s
		X17159 17159 3 Q4 1 01_08_2011 5 s
		X14325 14325 3 validation 2 01_08_2011 6 s
		X17419 17419 3 Q4 1 01_08_2011 7 s
		X16437 16437 3 Q4 1 01_08_2011 8 s
		X16172 16172 3 Q4 2 01_08_2011 9 s
		X16392 16392 3 Q4 2 01_08_2011 10 s
		X13875 13875 3 validation 2 01_08_2011 11 s
		POOL2 POOL2 p p p 01_08_2011 12 p
		X13117 13117 3 Q4 2 01_08_2011 13 s
		X13341 13341 3 Q1 2 01_08_2011 14 s
		X16888 16888 3 Q4 1 01_08_2011 15 s
		X17489 17489 3 Q4 2 01_08_2011 16 s
		X12718 12718 3 Q1 2 01_08_2011 17 s
		X16235 16235 3 Q4 2 01_08_2011 18 s
		X16878 16878 3 Q1 1 01_08_2011 19 s
		X12701 12701 3 validation 1 01_08_2011 20 s
		X16220 16220 3 Q4 2 01_08_2011 21 s
		X15635 15635 3 Q4 1 01_08_2011 22 s


Intensity_matrix.txt
	Model input Matrix Ions file BEFORE IMPLEMENTATION::

		samples POOL1 X12588 X17736 X15432 X17159 X14325 X17419 X16437 X16172 X16392 X13875 POOL2 X13117 X13341 X16888 X17489 X12718 X16235 X16878 X12701 X16220 X15635
		ion01 188.4140625 219.729126 122.5697632 123.5487671 805.8852539 183.4683838 37.33084106 151.8625488 97.12005615 91.24694824 69.87762451 195.4349365 112.4111938 136.7092285 159.9987793 172.1585693 0 117.5420532 133.6679688 80.05419922 160.0006104 760.0488281
		ion02 82.02575684 87.11358643 79.82391357 80.33862305 83.08575439 94.27703857 76.02288818 77.04394531 76.97564697 84.17669678 81.04943848 86.44024658 84.11865234 83.71282959 77.75219727 79.15936279 75.98492432 78.2835083 78.98760986 73.98388672 72.20550537 82.16448975
		ion03 25.31900024 24.2960968 23.29342651 31.54063416 30.3830719 22.42404175 35.44485474 26.38783264 17.1401825 21.27339172 20.25959778 26.33859253 18.17146301 26.32852173 24.30648804 28.34313965 29.37016296 18.23519897 24.48402405 25.38140869 24.35777283 21.31071472
		ion04 65.87536621 62.68716431 46.60232544 62.77856445 29.53218079 47.59136963 90.13983154 28.35336304 58.74325562 31.39331055 23.32928467 30.39666748 41.43960571 21.27049255 88.1161499 29.36820984 24.30200195 25.00007629 45.60662842 103.293457 37.46994019 87.09295654
		ion05 0 103.728544 279.5808214 884.2333448 824.5072072 434.6439081 764.82768 799.0972595 398.4002569 382.5370891 74.55342827 0 636.6596277 514.3863309 741.690017 412.3166491 660.8996555 57.36593795 102.2085264 455.6403091 548.6145486 515.8412195
		ion06 2711.785156 3465.292969 2469.75 3435.259766 2482.3125 2593.654297 1407.915039 1291.253906 2241.734375 1444.189453 3363.683594 2578.642578 2633.181641 3397.763672 3706.855469 3647.212891 3548.410156 3714.640625 1889.213867 2262.707031 2107.417969 2763.21875
		ion07 164.9023438 192.40625 140.7609863 192.4053955 139.7540283 140.748291 84.60144043 86.1819458 150.762207 89.90411377 207.5949707 164.0512695 149.8706055 186.336792 214.6140137 202.5360107 214.6877441 195.4482422 117.4679565 127.2941895 142.78479 163.0666504


Parameters
==========

Factor analysis  -> **batch**

Level of details  -> **no**

Model used (linear or not)  -> **Linear**


Output files
============

Norma_rdata_$detail.rdata::

	binary data
	Download, open with R send res


Norma_plots_$detail.pdf

.. image:: Vdk_pdf1.png
        :width: 800
        
.. image:: Vdk_pdf2.png
        :width: 800
        

Norma_result_for_simca.tabular::

	samples	idLIMS	serie	factor01	factor02	batch	injectionOrder	sampleType	ion01	ion02	ion03	ion04	ion05	ion06	ion07
	POOL1	POOL1	p	p	p	01_08_2011	1	p	183.806309736177	78.555522674121	24.2565782732588	67.2059357441544	0	2756.58450391724	158.052416850832
	POOL2	POOL2	p	p	p	01_08_2011	12	p	190.655485025641	82.783250185879	25.2333869921957	31.0106280849366	0	2621.24237826457	157.236695576441
	X12588	12588	3	validation	2	01_08_2011	2	s	220.281338788057	87.500123119505	24.4029802274792	62.5632990312483	94.2986763636364	3459.67039593807	193.243760535699
	X12701	12701	3	validation	1	01_08_2011	20	s	80.2553876257053	74.3121648660553	25.4930666232626	103.089356639338	414.218462818182	2259.03570054876	127.848278698451
	X12718	12718	3	Q1	2	01_08_2011	17	s	0	76.3220813847312	29.4993682273574	24.2539829611226	600.817868636364	3542.65272205883	215.622242057156
	X13117	13117	3	Q4	2	01_08_2011	13	s	112.693700265425	84.4919000357226	18.251402938821	41.3577240621519	578.781479727273	2628.90920103769	150.522965863022
	X13341	13341	3	Q1	2	01_08_2011	14	s	137.052799630498	84.0842765863284	26.4443462044465	21.2284636032788	467.623937181818	3392.25066785752	187.147883253472
	X13875	13875	3	validation	2	01_08_2011	11	s	70.0532376321925	81.4090675909135	20.3487238346046	23.2831876997425	67.7758438818182	3358.22588611392	208.498595063134
	X14325	14325	3	validation	2	01_08_2011	6	s	183.929467815501	94.695360623753	22.5226896299416	47.497332543935	395.130825545454	2589.44599169574	141.360943533866
	X15432	15432	3	validation	1	01_08_2011	4	s	123.859263984884	80.6950981610103	31.6793877676942	62.6545185712173	803.848495272727	3429.68592298187	193.242902316211
	X15635	15635	3	Q4	1	01_08_2011	22	s	761.958946663093	82.5290665188414	21.4044648499099	86.9208671903241	468.946563181818	2758.73531975414	163.776450823485
	X16172	16172	3	Q4	2	01_08_2011	9	s	97.3641336556051	77.3172000270102	17.2155856179699	58.6271832180619	362.182051727273	2238.0970735015	151.418448347397
	X16220	16220	3	Q4	2	01_08_2011	21	s	160.402716323636	72.5258925581935	24.4649275827679	37.3959023125888	498.740498727273	2103.99860111142	143.406307055514
	X16235	16235	3	Q4	2	01_08_2011	18	s	117.83745429722	78.6308645435113	18.315419286157	24.950677956983	52.1508526818182	3708.61347563638	196.298993992243
	X16392	16392	3	Q4	2	01_08_2011	10	s	91.4762657301598	84.5502020280356	21.3669776585093	31.3312796509314	347.760990090909	1441.84619925857	90.295450550822
	X16437	16437	3	Q4	1	01_08_2011	8	s	152.244202534309	77.3858014174909	26.5039180350956	28.2973388561794	726.452054090909	1289.1587961513	86.5570806388865
	X16878	16878	3	Q1	1	01_08_2011	19	s	134.003896781277	79.3380903129169	24.5917342073347	45.5165130382572	92.9168421818182	1886.14854378149	117.979273835979
	X16888	16888	3	Q4	1	01_08_2011	15	s	160.400880621802	78.0971960028743	24.4134171806386	87.9420387946402	674.263651818182	3700.84095135577	215.548190721704
	X17159	17159	3	Q4	1	01_08_2011	5	s	807.910566388206	83.4544189550015	30.5167331579687	29.4738273480161	749.552006545455	2478.28485110605	140.362352983359
	X17419	17419	3	Q4	1	01_08_2011	7	s	37.4246591541122	76.3602136963513	35.6007838010462	89.9617217868595	695.297890909091	1405.63064191075	84.9696956072378
	X17489	17489	3	Q4	2	01_08_2011	16	s	172.59123002765	79.510605337691	28.4678268347873	29.3101803926911	374.833317363636	3641.2951457659	203.417614300817
	X17736	17736	3	Q1	1	01_08_2011	3	s	122.877799698849	80.1781048340628	23.3958989887532	46.5102426333419	254.164383090909	2465.74273425251	141.373694094272


Norma_result.tabular::

	POOL1	POOL2	X12588	X12701	X12718	X13117	X13341	X13875	X14325	X15432	X15635	X16172	X16220	X16235	X16392	X16437	X16878	X16888	X17159	X17419	X17489	X17736
	ion01	183.806309736177	190.655485025641	220.281338788057	80.2553876257053	0	112.693700265425	137.052799630498	70.0532376321925	183.929467815501	123.859263984884	761.958946663093	97.3641336556051	160.402716323636	117.83745429722	91.4762657301598	152.244202534309	134.003896781277	160.400880621802	807.910566388206	37.4246591541122	172.59123002765	122.877799698849
	ion02	78.555522674121	82.783250185879	87.500123119505	74.3121648660553	76.3220813847312	84.4919000357226	84.0842765863284	81.4090675909135	94.695360623753	80.6950981610103	82.5290665188414	77.3172000270102	72.5258925581935	78.6308645435113	84.5502020280356	77.3858014174909	79.3380903129169	78.0971960028743	83.4544189550015	76.3602136963513	79.510605337691	80.1781048340628
	ion03	24.2565782732588	25.2333869921957	24.4029802274792	25.4930666232626	29.4993682273574	18.251402938821	26.4443462044465	20.3487238346046	22.5226896299416	31.6793877676942	21.4044648499099	17.2155856179699	24.4649275827679	18.315419286157	21.3669776585093	26.5039180350956	24.5917342073347	24.4134171806386	30.5167331579687	35.6007838010462	28.4678268347873	23.3958989887532
	ion04	67.2059357441544	31.0106280849366	62.5632990312483	103.089356639338	24.2539829611226	41.3577240621519	21.2284636032788	23.2831876997425	47.497332543935	62.6545185712173	86.9208671903241	58.6271832180619	37.3959023125888	24.950677956983	31.3312796509314	28.2973388561794	45.5165130382572	87.9420387946402	29.4738273480161	89.9617217868595	29.3101803926911	46.5102426333419
	ion05	0	0	94.2986763636364	414.218462818182	600.817868636364	578.781479727273	467.623937181818	67.7758438818182	395.130825545454	803.848495272727	468.946563181818	362.182051727273	498.740498727273	52.1508526818182	347.760990090909	726.452054090909	92.9168421818182	674.263651818182	749.552006545455	695.297890909091	374.833317363636	254.164383090909
	ion06	2756.58450391724	2621.24237826457	3459.67039593807	2259.03570054876	3542.65272205883	2628.90920103769	3392.25066785752	3358.22588611392	2589.44599169574	3429.68592298187	2758.73531975414	2238.0970735015	2103.99860111142	3708.61347563638	1441.84619925857	1289.1587961513	1886.14854378149	3700.84095135577	2478.28485110605	1405.63064191075	3641.2951457659	2465.74273425251
	ion07	158.052416850832	157.236695576441	193.243760535699	127.848278698451	215.622242057156	150.522965863022	187.147883253472	208.498595063134	141.360943533866	193.242902316211	163.776450823485	151.418448347397	143.406307055514	196.298993992243	90.295450550822	86.5570806388865	117.979273835979	215.548190721704	140.362352983359	84.9696956072378	203.417614300817	141.373694094272
-->
</tool>
